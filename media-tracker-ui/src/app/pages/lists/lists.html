<div class="lists-container" cdkDropListGroup>
  <app-list-sidebar
    [selectedFolderId]="(selectedFolderId$ | async)!"
    [folders]="folders$ | async"
    (folderSelect)="selectFolder($event)"
  ></app-list-sidebar>

  <main class="content">
    <div class="content-view">
      <header class="lists-header">
        <div class="header-main">
          <div class="header-actions">
            <app-list-filters
              [availableGenres]="availableGenres()"
              [availableStudios]="availableStudios()"
              class="filters-inline"
            ></app-list-filters>
            <button class="create-list-btn" (click)="openCreateListDialog()">
              <lucide-icon [img]="PlusIcon" [size]="20"></lucide-icon>
              <span>Create New List</span>
            </button>
          </div>
        </div>
      </header>

      <div class="lists-scroll-area">
        <div class="lists-grid" cdkDropList cdkDropListSortingDisabled="true">
          @for (list of enrichedLists$ | async; track list.id) {
            <div class="list-card-wrapper" cdkDrag [cdkDragData]="list">
              <app-list-card
                [list]="list"
                (cardClick)="onListSaved()" 
              ></app-list-card>

              <!-- Drag Preview -->
              <div *cdkDragPreview class="list-drag-preview">
                <div class="preview-content">
                  <lucide-icon [img]="ListIcon" [size]="20"></lucide-icon>
                  <span>{{ list.name }}</span>
                </div>
              </div>
            </div>
          }
        </div>

        @if ((enrichedLists$ | async)?.length === 0) {
          <div class="empty-lists-state">
            <lucide-icon [img]="ListIcon" [size]="64"></lucide-icon>
            <h2>No lists found in this folder</h2>
            <p>Create your first list or adjust filters to see results.</p>
            <button class="primary-btn" (click)="openCreateListDialog()">
              Create Now
            </button>
          </div>
        }
      </div>
    </div>
  </main>
</div>

<app-list-form (saved)="onListSaved()"></app-list-form>
