<aside class="side-column">
  <div class="main-poster">
    <img [src]="game()?.coverImage" [alt]="game()?.title">
  </div>

  <div class="sidebar-content">
    <div class="category-selector">
      <ui-select 
        [options]="categoryOptions" 
        [value]="game()?.statusId" 
        (valueChange)="onCategoryChange($event)"
        variant="prominent"
        rounding="full">
      </ui-select>
    </div>

  <div class="score-rating" (mouseleave)="onHover(null)">
    <div class="stars">
      @for (star of [1, 2, 3, 4, 5]; track star) {
        <button 
          class="star-btn" 
          [class.filled]="(hoveredStar() !== null ? hoveredStar()! : (game()?.score || 0)) >= star"
          (mouseenter)="onHover(star)"
          (click)="setScore(star)">
          <lucide-icon [img]="StarIcon" [size]="20" fill="currentColor"></lucide-icon>
        </button>
      }
      @if (hoveredStar() === 5 || hoveredStar() === 6 || (game()?.score || 0) === 6) {
        <button 
          class="star-btn special-star" 
          [class.filled]="(hoveredStar() !== null ? hoveredStar()! : (game()?.score || 0)) >= 6"
          (mouseenter)="onHover(6)"
          (click)="setScore(6)">
          <lucide-icon [img]="StarIcon" [size]="20" fill="currentColor"></lucide-icon>
        </button>
      }
    </div>
    @if (hoveredStar() !== null) {
      <span class="score-label">{{ currentLabel }}</span>
    }
  </div>

  <div class="side-actions">
    @if (game()?.progressCurrent) {
      <div class="game-progress">
        <div class="progress-info">
          <span>Playtime</span>
          <span class="count">{{ game()?.progressCurrent }} hours</span>
        </div>
      </div>
    }

    @if (game()?.platforms?.length) {
      <div class="platforms-list">
        <div class="progress-info">
          <span>Platforms</span>
        </div>
        <div class="platforms-grid">
           @for (platform of game()?.platforms; track platform) {
             <span class="platform-tag">
               <lucide-icon [img]="PlatformIcon" [size]="12"></lucide-icon>
               {{ platform }}
             </span>
           }
        </div>
      </div>
    }

    @if (game()?.trailerUrl) {
      <a [href]="game()?.trailerUrl" target="_blank" class="btn-primary">
        <lucide-icon [img]="PlayIcon" [size]="18"></lucide-icon>
        <span>Watch Trailer</span>
      </a>
    }

    <button class="btn-primary full-width" (click)="quickLog.emit()">
      <lucide-icon [img]="ClockIcon" [size]="18"></lucide-icon>
      <span>Quick Log 1h</span>
    </button>

    <button class="btn-outline full-width" (click)="onEdit()">
      <lucide-icon [img]="EditIcon" [size]="18"></lucide-icon>
      <span>Edit Game</span>
    </button>
  </div>

  <app-media-list-section
    [mediaId]="game()!.id!"
    [lists]="lists()"
    (updated)="listUpdated.emit()">
  </app-media-list-section>

  <div class="side-links">
    <app-anime-links [sourceLinks]="game()?.sourceLinks" (saveLinks)="onSaveLinks($event)"></app-anime-links>
  </div>
</div>
</aside>
