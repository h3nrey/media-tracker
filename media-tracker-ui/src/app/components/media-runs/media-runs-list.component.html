<div class="runs-container">
  <div class="header">
    <h3>
      <lucide-icon [img]="HistoryIcon"></lucide-icon>
      Histórico
    </h3>
    <div class="header-actions">
      @if (mediaType() === 'game' && runs().length > 0) {
        <button class="quick-log-btn" (click)="quickLogSession()" title="Quick Log 1h Session">
          <lucide-icon [img]="ClockIcon"></lucide-icon>
          Quick Log
        </button>
      }
      @if (runs().length > 0) {
        <button class="add-btn" (click)="createNewRun()">
          <lucide-icon [img]="PlusIcon"></lucide-icon>
          Start New Run
      </button>
      }
    </div>
  </div>

  <div class="runs-list">
    @for (run of runs(); track run.id; let isLast = $last) {
      <div 
          class="run-card" 
          [class.current-run]="isLast"
          (click)="openRunDetails(run)">
        
        <div class="run-info">
          <div class="run-header">
            <span class="run-badge">#{{ run.runNumber }}</span>
            @if (isLast) {
              <span class="current-badge">ATUAL</span>
            }
          </div>
          <div class="run-dates">
            <span class="label">{{ getRunLabel(run.runNumber) }}</span>
            <span class="date-range">
              {{ formatDate(run.startDate) }} — {{ run.endDate ? formatDate(run.endDate) : 'Ongoing' }}
            </span>
          </div>
        </div>

        <div class="run-meta">
          @if (run.rating) {
            <div class="rating-badge" [ngClass]="getScoreColorClass(run.rating)">
              <lucide-icon [img]="StarIcon" [size]="14" fill="currentColor"></lucide-icon>
              {{ run.rating }}
            </div>
          }
          <button class="delete-btn" (click)="deleteRun($event, run.id!)" title="Delete Run">
            <lucide-icon [img]="DeleteIcon" [size]="18"></lucide-icon>
          </button>
        </div>
      </div>
    } @empty {
      <div class="empty-state">
        <lucide-icon [img]="EmptyIcon" [size]="48"></lucide-icon>
        <p>Nenhuma sessão registrada ainda. Adicione sua primeira sessão para começar a registrar suas sessões!</p>
        <button class="start-btn" (click)="createNewRun()">
          <lucide-icon [img]="PlayIcon"></lucide-icon>
          Adicione sua primeira sessão
        </button>
      </div>
    }
  </div>
</div>
